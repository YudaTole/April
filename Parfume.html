<!doctype html>

<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>April Parfume â€” Kalkulator & Kirim WA</title>
  <meta name="description" content="Kalkulator penjualan parfum dengan login dan kirim WhatsApp otomatis." />
  <style>
    :root {
      --bg: #0f172a;         /* slate-900 */
      --card: #111827;       /* gray-900 */
      --muted: #94a3b8;      /* slate-400 */
      --text: #e5e7eb;       /* gray-200 */
      --accent: #22d3ee;     /* cyan-400 */
      --accent-2: #a78bfa;   /* violet-400 */
      --ok: #34d399;         /* emerald-400 */
      --warn: #f59e0b;       /* amber-500 */
      --danger: #f87171;     /* red-400 */
      --ring: rgba(34, 211, 238, .35);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 20% 0%, rgba(167,139,250,.15), transparent 60%),
                  radial-gradient(1000px 700px at 100% 0%, rgba(34,211,238,.12), transparent 60%),
                  var(--bg);
      color: var(--text);
    }
    .container { max-width: 1000px; margin: 32px auto; padding: 16px; }
    .logo { display:flex; gap:10px; align-items:center; justify-content:center; margin-bottom: 24px; }
    .logo .badge { padding: 6px 10px; border-radius: 999px; font-size: 12px; color: #0b1020; background: linear-gradient(90deg, var(--accent), var(--accent-2)); }
    .card { background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.04)); border:1px solid rgba(255,255,255,.08); box-shadow: 0 10px 30px rgba(0,0,0,.35); backdrop-filter: blur(6px); border-radius: 18px; padding: 20px; }
    .grid { display:grid; gap: 12px; }
    .grid.cols-2 { grid-template-columns: repeat(2, minmax(0,1fr)); }
    .grid.cols-3 { grid-template-columns: repeat(3, minmax(0,1fr)); }
    @media (max-width: 820px){ .grid.cols-2, .grid.cols-3 { grid-template-columns: 1fr; } }label { font-size: 12px; color: var(--muted); display:block; margin-bottom: 6px; }
input, select, textarea { width:100%; padding: 12px 14px; background: #0b1225; border:1px solid rgba(255,255,255,.08); border-radius: 12px; color: var(--text); outline:none; transition: .2s; }
textarea { min-height: 64px; resize: vertical; }
input:focus, select:focus, textarea:focus { box-shadow: 0 0 0 8px var(--ring); border-color: var(--accent); }

.row { display:flex; gap: 10px; align-items:center; }
.row > * { flex:1; }

.btns { display:flex; gap:10px; flex-wrap:wrap; }
button { cursor:pointer; border:0; border-radius: 12px; padding: 12px 16px; color:#0b1020; font-weight:600; }
.btn-primary { background: linear-gradient(90deg, var(--accent), var(--accent-2)); }
.btn-secondary { background: #e5e7eb; }
.btn-ghost { background: transparent; color: var(--text); border:1px dashed rgba(255,255,255,.25); }

.totals { display:grid; gap:10px; grid-template-columns: repeat(3, minmax(0,1fr)); }
.totals .tile { background:#0b1225; border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:14px; }
.totals h4 { margin:0 0 4px; font-size:12px; color:var(--muted); }
.totals .num { font-size:20px; font-weight:800; letter-spacing:.2px; }

.center { text-align:center; }
.hide { display:none !important; }
.sep { height:1px; background: rgba(255,255,255,.12); margin: 16px 0; }
.small { font-size:12px; color:var(--muted); }
.right { text-align:right; }
.danger { color: var(--danger); }

  </style>
</head>
<body>
  <div class="container">
    <div class="logo">
      <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 2c2 2 3 4.5 3 7a5 5 0 1 1-6 0c0-2.5 1-5 3-7Z" stroke="url(#g1)" stroke-width="1.2"/>
        <path d="M8 20h8" stroke="url(#g2)" stroke-width="1.4" stroke-linecap="round"/>
        <defs>
          <linearGradient id="g1" x1="0" x2="24" y1="0" y2="24" gradientUnits="userSpaceOnUse">
            <stop stop-color="#22d3ee"/><stop offset="1" stop-color="#a78bfa"/>
          </linearGradient>
          <linearGradient id="g2" x1="0" x2="24" y1="0" y2="24" gradientUnits="userSpaceOnUse">
            <stop stop-color="#22d3ee"/><stop offset="1" stop-color="#a78bfa"/>
          </linearGradient>
        </defs>
      </svg>
      <div>
        <div class="badge">April Parfume</div>
        <div class="small center">Kalkulator & Kirim WhatsApp</div>
      </div>
    </div><!-- LOGIN CARD -->
<section id="loginCard" class="card" aria-label="Login">
  <h2 class="center" style="margin:0 0 4px">Login</h2>
  <p class="small center" style="margin:0 0 18px">Khusus pemakaian pribadi. Masukkan ID & Password.</p>
  <div class="grid cols-2">
    <div>
      <label for="loginId">ID</label>
      <input id="loginId" placeholder="contoh: April parfume" autocomplete="username" />
    </div>
    <div>
      <label for="loginPw">Password</label>
      <input id="loginPw" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" />
    </div>
  </div>
  <div class="row" style="margin-top:12px">
    <button class="btn-primary" id="btnLogin">Masuk</button>
    <button class="btn-ghost" id="btnClearSession">Hapus Sesi</button>
  </div>
  <p id="loginMsg" class="small danger hide" style="margin-top:10px">ID atau Password salah.</p>
  <p class="small" style="margin-top:10px">Tip: Setelah login, browser akan mengingat sesi sampai tab ditutup.</p>
</section>

<!-- APP CARD -->
<section id="appCard" class="card hide" aria-label="Kalkulator Parfum">
  <div class="row" style="justify-content:space-between; align-items:baseline;">
    <h2 style="margin:0">Kalkulator Parfum</h2>
    <button class="btn-ghost" id="btnLogout">Keluar</button>
  </div>

  <div class="sep"></div>

  <div class="grid cols-3">
    <div>
      <label for="namaBibit">Nama Bibit</label>
      <input id="namaBibit" placeholder="Mis. Melati Keraton" />
    </div>
    <div>
      <label for="jenisBotol">Jenis Botol</label>
      <input id="jenisBotol" placeholder="Mis. Kabel 15ml / Roll on" />
    </div>
    <div>
      <label for="kualitas">Kualitas</label>
      <select id="kualitas">
        <option value="Standar">Standar</option>
        <option value="Premium">Premium</option>
        <option value="Eksklusif">Eksklusif</option>
      </select>
    </div>
  </div>

  <div class="grid cols-3" style="margin-top:8px">
    <div>
      <label for="mlBibit">Bibit (ml)</label>
      <input id="mlBibit" type="number" min="0" step="0.1" value="5" />
    </div>
    <div>
      <label for="mlAlkohol">Alkohol (ml)</label>
      <input id="mlAlkohol" type="number" min="0" step="0.1" value="10" />
    </div>
    <div>
      <label for="qty">Qty (pcs)</label>
      <input id="qty" type="number" min="1" step="1" value="1" />
    </div>
  </div>

  <div class="grid cols-3" style="margin-top:8px">
    <div>
      <label for="hargaBibit">Harga Bibit / ml (Rp)</label>
      <input id="hargaBibit" type="number" min="0" step="100" value="1500" />
    </div>
    <div>
      <label for="hargaAlkohol">Harga Alkohol / ml (Rp)</label>
      <input id="hargaAlkohol" type="number" min="0" step="50" value="150" />
    </div>
    <div>
      <label for="hargaBotol">Harga Botol (Rp)</label>
      <input id="hargaBotol" type="number" min="0" step="100" value="3000" />
    </div>
  </div>

  <div class="grid cols-3" style="margin-top:8px">
    <div>
      <label for="diskon">Diskon (Rp)</label>
      <input id="diskon" type="number" min="0" step="100" value="0" />
    </div>
    <div>
      <label for="ongkir">Ongkir (Rp)</label>
      <input id="ongkir" type="number" min="0" step="500" value="0" />
    </div>
    <div>
      <label for="catatan">Catatan</label>
      <input id="catatan" placeholder="Opsional" />
    </div>
  </div>

  <div class="sep"></div>

  <div class="totals">
    <div class="tile">
      <h4>Biaya per pcs</h4>
      <div id="biayaPerPcs" class="num">Rp 0</div>
    </div>
    <div class="tile">
      <h4>Subtotal (Ã— Qty)</h4>
      <div id="subtotal" class="num">Rp 0</div>
    </div>
    <div class="tile">
      <h4>Grand Total</h4>
      <div id="grandTotal" class="num">Rp 0</div>
    </div>
  </div>

  <div class="sep"></div>

  <div class="btns">
    <button class="btn-primary" id="btnWA">Kirim via WhatsApp</button>
    <button class="btn-secondary" id="btnReset">Reset Form</button>
    <button class="btn-ghost" id="btnGantiWA">Ganti Nomor WA Tujuan</button>
    <span class="small" id="waInfo"></span>
  </div>

  <p class="small" style="margin-top:12px">Semua input otomatis tersimpan di perangkat (localStorage). Tidak ada data yang dikirim ke server.</p>
</section>

  </div>  <script>
    /********************
     * KONFIGURASI LOGIN & WHATSAPP
     ********************/
    const CONFIG = {
      LOGIN_ID: "April parfume",      // ganti jika perlu
      LOGIN_PW: "05092003",           // ganti jika perlu
      WA_NUMBER_RAW: "085135673054",   // ganti jika perlu (format bebas 08xxx atau 62xxx)
      STORAGE_KEY: "april-parfume-kalkulator-v1"
    };

    function to62Number(num){
      const digits = (num || "").replace(/[^0-9]/g, "");
      if (!digits) return "";
      if (digits.startsWith("62")) return digits;      // sudah 62
      if (digits.startsWith("0")) return "62" + digits.slice(1);
      return "62" + digits; // fallback
    }

    let WA_NUMBER_62 = to62Number(CONFIG.WA_NUMBER_RAW);

    /********************
     * ELEM GETTER
     ********************/
    const $ = (id) => document.getElementById(id);

    const loginCard = $("loginCard");
    const appCard   = $("appCard");
    const loginId   = $("loginId");
    const loginPw   = $("loginPw");
    const loginMsg  = $("loginMsg");

    const inputs = {
      namaBibit: $("namaBibit"),
      jenisBotol: $("jenisBotol"),
      kualitas: $("kualitas"),
      mlBibit: $("mlBibit"),
      mlAlkohol: $("mlAlkohol"),
      qty: $("qty"),
      hargaBibit: $("hargaBibit"),
      hargaAlkohol: $("hargaAlkohol"),
      hargaBotol: $("hargaBotol"),
      diskon: $("diskon"),
      ongkir: $("ongkir"),
      catatan: $("catatan"),
    };

    const out = {
      biayaPerPcs: $("biayaPerPcs"),
      subtotal: $("subtotal"),
      grandTotal: $("grandTotal"),
      waInfo: $("waInfo"),
    };

    /********************
     * UTIL
     ********************/
    const toRupiah = (n=0) => new Intl.NumberFormat("id-ID", { style: "currency", currency: "IDR", maximumFractionDigits: 0 }).format(Math.round(n||0));
    const toDateID = (d=new Date()) => {
      const dd = String(d.getDate()).padStart(2,'0');
      const mm = String(d.getMonth()+1).padStart(2,'0');
      const yyyy = d.getFullYear();
      return ${dd}/${mm}/${yyyy};
    };

    function getNum(el){ return parseFloat(el.value || 0) || 0; }

    function saveLocal(){
      const data = Object.fromEntries(Object.entries(inputs).map(([k,el]) => [k, el.value]));
      localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify({ data, wa: WA_NUMBER_62 }));
    }

    function loadLocal(){
      const raw = localStorage.getItem(CONFIG.STORAGE_KEY);
      if(!raw) return;
      try{
        const { data, wa } = JSON.parse(raw);
        if (data){ Object.entries(data).forEach(([k,v]) => { if(inputs[k]) inputs[k].value = v; }); }
        if (wa){ WA_NUMBER_62 = wa; }
      }catch(e){ console.warn('loadLocal failed', e); }
    }

    function calc(){
      const mlBibit = getNum(inputs.mlBibit);
      const mlAlkohol = getNum(inputs.mlAlkohol);
      const hargaBibit = getNum(inputs.hargaBibit);
      const hargaAlkohol = getNum(inputs.hargaAlkohol);
      const hargaBotol = getNum(inputs.hargaBotol);
      const qty = Math.max(1, Math.floor(getNum(inputs.qty)));
      const diskon = getNum(inputs.diskon);
      const ongkir = getNum(inputs.ongkir);

      const biayaBahan = (mlBibit * hargaBibit) + (mlAlkohol * hargaAlkohol) + hargaBotol;
      const biayaPerPcs = Math.max(0, biayaBahan);
      const subtotal = biayaPerPcs * qty;
      const grandTotal = Math.max(0, subtotal - diskon + ongkir);

      out.biayaPerPcs.textContent = toRupiah(biayaPerPcs);
      out.subtotal.textContent = toRupiah(subtotal);
      out.grandTotal.textContent = toRupiah(grandTotal);

      saveLocal();
    }

    function buildWAMessage(){
      const lines = [];
      lines.push("ðŸª» Data Pemesanan Parfum ðŸª»\n");
      lines.push(ðŸ“… Tanggal: ${toDateID(new Date())});
      lines.push(`ðŸŒ¸ Nama Bibit: ${inputs.namaBibit.value || '-'} `);
      lines.push(`ðŸ§´ Jenis Botol: ${inputs.jenisBotol.value || '-'} `);
      lines.push(`âœ¨ Kualitas: ${inputs.kualitas.value || '-'} `);
      lines.push("\nâš—ï¸ Komposisi:");
      lines.push(- Bibit: ${getNum(inputs.mlBibit)} ml);
      lines.push(- Alkohol: ${getNum(inputs.mlAlkohol)} ml);
      lines.push("\nðŸ’µ Perhitungan:");
      lines.push(- Harga bibit/ml: ${toRupiah(getNum(inputs.hargaBibit))});
      lines.push(- Harga alkohol/ml: ${toRupiah(getNum(inputs.hargaAlkohol))});
      lines.push(- Harga botol: ${toRupiah(getNum(inputs.hargaBotol))});
      lines.push(- Qty: ${Math.max(1, Math.floor(getNum(inputs.qty)))});
      if (getNum(inputs.diskon) > 0) lines.push(- Diskon: ${toRupiah(getNum(inputs.diskon))});
      if (getNum(inputs.ongkir) > 0) lines.push(- Ongkir: ${toRupiah(getNum(inputs.ongkir))});
      lines.push("\nðŸ’° Total:");
      lines.push(- Biaya per pcs: ${out.biayaPerPcs.textContent});
      lines.push(- Subtotal: ${out.subtotal.textContent});
      lines.push(- Grand total: *${out.grandTotal.textContent}*);
      if ((inputs.catatan.value || '').trim()){
        lines.push("\nðŸ“ Catatan:");
        lines.push(inputs.catatan.value.trim());
      }
      lines.push("\nTerima kasih ðŸ™");
      return lines.join("\n");
    }

    function openWA(){
      if(!WA_NUMBER_62){ alert('Nomor WhatsApp tujuan belum diset.'); return; }
      const msg = buildWAMessage();
      const url = https://wa.me/${WA_NUMBER_62}?text=${encodeURIComponent(msg)};
      window.open(url, '_blank');
    }

    function setWAInfo(){
      out.waInfo.textContent = WA tujuan: +${WA_NUMBER_62};
    }

    /********************
     * EVENT BINDINGS
     ********************/
    document.addEventListener('DOMContentLoaded', () => {
      // Restore session
      if (sessionStorage.getItem('april-auth') === 'ok') {
        showApp();
      }

      loadLocal();
      calc();
      setWAInfo();

      Object.values(inputs).forEach(el => el.addEventListener('input', calc));

      $("btnWA").addEventListener('click', openWA);
      $("btnReset").addEventListener('click', () => {
        Object.values(inputs).forEach(el => { if (el.type === 'number') el.value = 0; else el.value = ''; });
        inputs.mlBibit.value = 5; inputs.mlAlkohol.value = 10; inputs.qty.value = 1; inputs.hargaBibit.value = 1500; inputs.hargaAlkohol.value = 150; inputs.hargaBotol.value = 3000; inputs.diskon.value = 0; inputs.ongkir.value = 0;
        calc();
      });

      $("btnGantiWA").addEventListener('click', () => {
        const now = "+" + WA_NUMBER_62;
        const val = prompt('Masukkan nomor WA tujuan (boleh 08xxx atau 62xxx):', now);
        if (val !== null){
          WA_NUMBER_62 = to62Number(val);
          setWAInfo();
          saveLocal();
        }
      });

      // LOGIN
      $("btnLogin").addEventListener('click', doLogin);
      loginPw.addEventListener('keydown', (e)=>{ if(e.key==='Enter') doLogin(); });
      loginId.addEventListener('keydown', (e)=>{ if(e.key==='Enter') doLogin(); });
      $("btnClearSession").addEventListener('click', () => {
        sessionStorage.removeItem('april-auth');
        loginMsg.classList.add('hide');
        alert('Sesi dibersihkan.');
      });
      $("btnLogout").addEventListener('click', () => {
        sessionStorage.removeItem('april-auth');
        showLogin();
      });
    });

    function doLogin(){
      const id = (loginId.value || '').trim();
      const pw = (loginPw.value || '').trim();
      // Catatan: ini login sederhana (client-side). Untuk keamanan penuh, gunakan backend.
      if (id === CONFIG.LOGIN_ID && pw === CONFIG.LOGIN_PW){
        sessionStorage.setItem('april-auth','ok');
        loginMsg.classList.add('hide');
        showApp();
      } else {
        loginMsg.classList.remove('hide');
      }
    }

    function showApp(){
      loginCard.classList.add('hide');
      appCard.classList.remove('hide');
    }

    function showLogin(){
      appCard.classList.add('hide');
      loginCard.classList.remove('hide');
    }
  </script></body>
</html>
