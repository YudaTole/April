<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Penjualan April Parfum</title>
  <style>
    body {
      margin: 0; font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #2c3e50, #34495e); color: #fff;
    }
    .container {
      max-width: 600px; margin: 50px auto; background: #1e272e;
      padding: 20px; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }
    h2 { text-align: center; margin-bottom: 20px; }
    input, select, button {
      width: 100%; padding: 10px; margin: 10px 0;
      border: none; border-radius: 8px; font-size: 14px;
    }
    input, select { background: #2d3436; color: #fff; }
    button { background: #0984e3; color: white; cursor: pointer; font-weight: bold; }
    button:hover { background: #74b9ff; }
    .hidden { display: none; }
    table {
      width: 100%; border-collapse: collapse; margin-top: 15px;
    }
    th, td {
      border: 1px solid #555; padding: 8px; text-align: center;
    }
    th { background: #0984e3; }
    .logout {
      background: #d63031; margin-top: 10px;
    }
    .logout:hover { background: #ff7675; }
    .hapusBtn {
      background: #d63031; color: #fff; border: none; padding: 5px 10px;
      border-radius: 5px; cursor: pointer;
    }
    .hapusBtn:hover { background: #ff7675; }
  </style>
</head>
<body>
  <div class="container" id="authPage">
    <h2>Login / Register</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <button onclick="register()">Register</button>
  </div>

  <div class="container hidden" id="mainPage">
    <h2>Penjualan April Parfum</h2>
    <input type="text" id="namaPembeli" placeholder="Nama Pembeli">
    <input type="text" id="namaBibit" placeholder="Nama Bibit (contoh: Zara Man)">
    <select id="mili">
      <option value="">Pilih Ukuran Botol (ml)</option>
      <option value="4">4 ml</option>
      <option value="8">8 ml</option>
      <option value="10">10 ml</option>
    </select>
    <select id="kualitas">
      <option value="">Pilih Kualitas</option>
      <option value="Murni">Murni</option>
      <option value="Premium">Premium</option>
      <option value="Sedang">Sedang</option>
      <option value="Standar">Standar</option>
    </select>
    <input type="text" id="harga" placeholder="Harga otomatis" readonly>
    <button onclick="tambahTransaksi()">Tambah Transaksi</button>
    <button class="logout" onclick="logout()">Logout</button>

    <h3>Daftar Transaksi</h3>
    <table>
      <thead>
        <tr>
          <th>Pembeli</th>
          <th>Bibit</th>
          <th>Ukuran</th>
          <th>Kualitas</th>
          <th>Harga</th>
          <th>Tanggal</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="transaksiList"></tbody>
    </table>

    <h3>Total Penjualan: <span id="totalPenjualan">Rp 0</span></h3>
  </div>

  <script>
    // Harga tabel (mili -> kualitas -> harga)
    const hargaTabel = {
      4: { Murni: 10000, Premium: 8500, Sedang: 7500, Standar: 4500 },
      8: { Murni: 20000, Premium: 16500, Sedang: 13500, Standar: 9500 },
      10: { Murni: 25000, Premium: 21000, Sedang: 21000, Standar: 12000 }
    };

    const authPage = document.getElementById("authPage");
    const mainPage = document.getElementById("mainPage");

    // Cek login
    if(localStorage.getItem("loggedInUser")){
      authPage.classList.add("hidden");
      mainPage.classList.remove("hidden");
      renderTransaksi();
    }

    function login(){
      let user = document.getElementById("username").value;
      let pass = document.getElementById("password").value;
      let savedUser = localStorage.getItem("user_" + user);
      if(savedUser && JSON.parse(savedUser).password === pass){
        localStorage.setItem("loggedInUser", user);
        authPage.classList.add("hidden");
        mainPage.classList.remove("hidden");
        renderTransaksi();
      } else {
        alert("Username / Password salah!");
      }
    }

    function register(){
      let user = document.getElementById("username").value;
      let pass = document.getElementById("password").value;
      if(localStorage.getItem("user_" + user)){
        alert("Username sudah ada!");
        return;
      }
      localStorage.setItem("user_" + user, JSON.stringify({username: user, password: pass}));
      alert("Register berhasil, silakan login.");
    }

    function logout(){
      localStorage.removeItem("loggedInUser");
      location.reload();
    }

    // Kalkulasi harga otomatis
    document.getElementById("mili").addEventListener("change", hitungHarga);
    document.getElementById("kualitas").addEventListener("change", hitungHarga);

    function hitungHarga(){
      let ml = document.getElementById("mili").value;
      let kualitas = document.getElementById("kualitas").value;
      if(ml && kualitas){
        document.getElementById("harga").value = "Rp " + hargaTabel[ml][kualitas].toLocaleString();
      }
    }

    // Tambah transaksi
    function tambahTransaksi(){
      let pembeli = document.getElementById("namaPembeli").value;
      let bibit = document.getElementById("namaBibit").value;
      let ml = document.getElementById("mili").value;
      let kualitas = document.getElementById("kualitas").value;
      if(!pembeli || !bibit || !ml || !kualitas){
        alert("Lengkapi semua data!");
        return;
      }
      let harga = hargaTabel[ml][kualitas];

      // Buat tanggal transaksi (Hari, Tanggal Bulan Tahun)
      let now = new Date();
      let options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      let tanggal = now.toLocaleDateString('id-ID', options);

      let transaksi = JSON.parse(localStorage.getItem("transaksi")) || [];
      transaksi.push({pembeli, bibit, ml, kualitas, harga, tanggal});
      localStorage.setItem("transaksi", JSON.stringify(transaksi));
      renderTransaksi();

      // reset input
      document.getElementById("namaPembeli").value = "";
      document.getElementById("namaBibit").value = "";
      document.getElementById("mili").value = "";
      document.getElementById("kualitas").value = "";
      document.getElementById("harga").value = "";
    }

    function renderTransaksi(){
      let transaksi = JSON.parse(localStorage.getItem("transaksi")) || [];
      let list = document.getElementById("transaksiList");
      list.innerHTML = "";
      let total = 0;
      transaksi.forEach((t, index) => {
        total += t.harga;
        list.innerHTML += `<tr>
          <td>${t.pembeli}</td>
          <td>${t.bibit}</td>
          <td>${t.ml} ml</td>
          <td>${t.kualitas}</td>
          <td>Rp ${t.harga.toLocaleString()}</td>
          <td>${t.tanggal}</td>
          <td><button class="hapusBtn" onclick="hapusTransaksi(${index})">Hapus</button></td>
        </tr>`;
      });
      document.getElementById("totalPenjualan").innerText = "Rp " + total.toLocaleString();
    }

    function hapusTransaksi(index){
      let transaksi = JSON.parse(localStorage.getItem("transaksi")) || [];
      transaksi.splice(index, 1); // hapus data
      localStorage.setItem("transaksi", JSON.stringify(transaksi));
      renderTransaksi();
    }
  </script>
</body>
</html>
